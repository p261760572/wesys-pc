!function(t){function e(e,i){var o=t.data(e,"form").options;t.extend(o,i||{});var r=t.extend({},o.queryParams);if(0!=o.onSubmit.call(e,r)){var s=t(e).find(".textbox-text:focus");s.triggerHandler("blur"),s.focus();var d=null;if(o.dirty){var f=[];t.map(o.dirtyFields,function(e){t(e).hasClass("textbox-f")?t(e).next().find(".textbox-value").each(function(){f.push(this)}):f.push(e)}),d=t(e).find("input[name]:enabled,textarea[name]:enabled,select[name]:enabled").filter(function(){return-1==t.inArray(this,f)}),d.attr("disabled","disabled")}o.ajax?o.iframe?n(e,r):void 0!==window.FormData?a(e,r):n(e,r):t(e).submit(),o.dirty&&d.removeAttr("disabled")}}function n(e,n){function a(){var e=t("#"+r);if(e.length)try{var n=e.contents()[0].readyState;n&&"uninitialized"==n.toLowerCase()&&setTimeout(a,100)}catch(t){i()}}function i(){var n=t("#"+r);if(n.length){n.unbind();var a="";try{var s=n.contents().find("body");if(""==(a=s.html())&&--d)return void setTimeout(i,100);var f=s.find(">textarea");if(f.length)a=f.val();else{var l=s.find(">pre");l.length&&(a=l.html())}}catch(t){}o.success.call(e,a),setTimeout(function(){n.unbind(),n.remove()},100)}}var o=t.data(e,"form").options,r="easyui_frame_"+(new Date).getTime(),s=t("<iframe id="+r+" name="+r+"></iframe>").appendTo("body");s.attr("src",window.ActiveXObject?"javascript:false":"about:blank"),s.css({position:"absolute",top:-1e3,left:-1e3}),s.bind("load",i),function(n){var i=t(e);o.url&&i.attr("action",o.url);var s=i.attr("target"),d=i.attr("action");i.attr("target",r);var f=t();try{for(var l in n){var c=t('<input type="hidden" name="'+l+'">').val(n[l]).appendTo(i);f=f.add(c)}a(),i[0].submit()}finally{i.attr("action",d),s?i.attr("target",s):i.removeAttr("target"),f.remove()}}(n);var d=10}function a(e,n){var a=t.data(e,"form").options,i=new FormData(t(e)[0]);for(var o in n)i.append(o,n[o]);t.ajax({url:a.url,type:"post",xhr:function(){var n=t.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(t){if(t.lengthComputable){var n=t.total,i=t.loaded||t.position,o=Math.ceil(100*i/n);a.onProgress.call(e,o)}},!1),n},data:i,dataType:"html",cache:!1,contentType:!1,processData:!1,complete:function(t){a.success.call(e,t.responseText)}})}function i(e,n){function a(n){var a=t(e);for(var o in n){var d=n[o];i(o,d)||r(o,d)||(a.find('input[name="'+o+'"]').val(d),a.find('textarea[name="'+o+'"]').val(d),a.find('select[name="'+o+'"]').val(d))}s.onLoadSuccess.call(e,n),a.form("validate")}function i(n,a){var i=t(e).find('[switchbuttonName="'+n+'"]');return i.length?(i.switchbutton("uncheck"),i.each(function(){o(t(this).switchbutton("options").value,a)&&t(this).switchbutton("check")}),!0):(i=t(e).find('input[name="'+n+'"][type=radio], input[name="'+n+'"][type=checkbox]'),!!i.length&&(i._propAttr("checked",!1),i.each(function(){o(t(this).val(),a)&&t(this)._propAttr("checked",!0)}),!0))}function o(e,n){return e==String(n)||t.inArray(e,t.isArray(n)?n:[n])>=0}function r(n,a){var i=t(e).find('[textboxName="'+n+'"],[sliderName="'+n+'"]');if(i.length)for(var o=0;o<s.fieldTypes.length;o++){var r=s.fieldTypes[o],d=i.data(r);if(d)return d.options.multiple||d.options.range?i[r]("setValues",a):i[r]("setValue",a),!0}return!1}var s=t.data(e,"form").options;if("string"==typeof n){var d={};if(0==s.onBeforeLoad.call(e,d))return;t.ajax({url:n,data:d,dataType:"json",success:function(t){a(t)},error:function(){s.onLoadError.apply(e,arguments)}})}else a(n)}function o(e){t("input,select,textarea",e).each(function(){if(!t(this).hasClass("textbox-value")){var e=this.type,n=this.tagName.toLowerCase();if("text"==e||"hidden"==e||"password"==e||"textarea"==n)this.value="";else if("file"==e){var a=t(this);if(!a.hasClass("textbox-value")){var i=a.clone().val("");i.insertAfter(a),a.data("validatebox")?(a.validatebox("destroy"),i.validatebox()):a.remove()}}else"checkbox"==e||"radio"==e?this.checked=!1:"select"==n&&(this.selectedIndex=-1)}});for(var n=t(),a=t(e),i=t.data(e,"form").options,o=0;o<i.fieldTypes.length;o++){var r=i.fieldTypes[o],s=a.find("."+r+"-f").not(n);s.length&&s[r]&&(s[r]("clear"),n=n.add(s))}a.form("validate")}function r(e){e.reset();for(var n=t(e),a=t.data(e,"form").options,i=a.fieldTypes.length-1;i>=0;i--){var o=a.fieldTypes[i],r=n.find("."+o+"-f");r.length&&r[o]&&r[o]("reset")}n.form("validate")}function s(n){var a=t.data(n,"form").options;t(n).unbind(".form"),a.ajax&&t(n).bind("submit.form",function(){return setTimeout(function(){e(n,a)},0),!1}),t(n).bind("_change.form",function(e,n){-1==t.inArray(n,a.dirtyFields)&&a.dirtyFields.push(n),a.onChange.call(this,n)}).bind("change.form",function(e){var n=e.target;t(n).hasClass("textbox-text")||(-1==t.inArray(n,a.dirtyFields)&&a.dirtyFields.push(n),a.onChange.call(this,n))}),l(n,a.novalidate)}function d(e,n){n=n||{};var a=t.data(e,"form");a?t.extend(a.options,n):t.data(e,"form",{options:t.extend({},t.fn.form.defaults,t.fn.form.parseOptions(e),n)})}function f(e){if(t.fn.validatebox){var n=t(e);n.find(".validatebox-text:not(:disabled)").validatebox("validate");var a=n.find(".validatebox-invalid");return a.filter(":not(:disabled):first").focus(),0==a.length}return!0}function l(e,n){t.data(e,"form").options.novalidate=n,t(e).find(".validatebox-text").validatebox(n?"disableValidation":"enableValidation")}t.fn.form=function(e,n){return"string"==typeof e?(this.each(function(){d(this)}),t.fn.form.methods[e](this,n)):this.each(function(){d(this,e),s(this)})},t.fn.form.methods={options:function(e){return t.data(e[0],"form").options},submit:function(t,n){return t.each(function(){e(this,n)})},load:function(t,e){return t.each(function(){i(this,e)})},clear:function(t){return t.each(function(){o(this)})},reset:function(t){return t.each(function(){r(this)})},validate:function(t){return f(t[0])},disableValidation:function(t){return t.each(function(){l(this,!0)})},enableValidation:function(t){return t.each(function(){l(this,!1)})},resetValidation:function(e){return e.each(function(){t(this).find(".validatebox-text:not(:disabled)").validatebox("resetValidation")})},resetDirty:function(e){return e.each(function(){t(this).form("options").dirtyFields=[]})}},t.fn.form.parseOptions=function(e){var n=t(e);return t.extend({},t.parser.parseOptions(e,[{ajax:"boolean",dirty:"boolean"}]),{url:n.attr("action")?n.attr("action"):void 0})},t.fn.form.defaults={fieldTypes:["combobox","combotree","combogrid","combotreegrid","datetimebox","datebox","combo","datetimespinner","timespinner","numberspinner","spinner","slider","searchbox","numberbox","passwordbox","filebox","textbox","switchbutton"],novalidate:!1,ajax:!0,iframe:!0,dirty:!1,dirtyFields:[],url:null,queryParams:{},onSubmit:function(e){return t(this).form("validate")},onProgress:function(t){},success:function(t){},onBeforeLoad:function(t){},onLoadSuccess:function(t){},onLoadError:function(){},onChange:function(t){}}}(jQuery);